{"version":3,"file":"react-easy-crop.js","sources":["../../node_modules/tslib/tslib.es6.js","../../src/helpers.ts","../../src/index.tsx"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { Area, MediaSize, Point, Size } from './types'\n\n/**\n * Compute the dimension of the crop area based on media size,\n * aspect ratio and optionally rotation\n */\nexport function getCropSize(\n  mediaWidth: number,\n  mediaHeight: number,\n  containerWidth: number,\n  containerHeight: number,\n  aspect: number,\n  rotation = 0\n): Size {\n  const { width, height } = translateSize(mediaWidth, mediaHeight, rotation)\n  const fittingWidth = Math.min(width, containerWidth)\n  const fittingHeight = Math.min(height, containerHeight)\n\n  if (fittingWidth > fittingHeight * aspect) {\n    return {\n      width: fittingHeight * aspect,\n      height: fittingHeight,\n    }\n  }\n\n  return {\n    width: fittingWidth,\n    height: fittingWidth / aspect,\n  }\n}\n\n/**\n * Ensure a new media position stays in the crop area.\n */\nexport function restrictPosition(\n  position: Point,\n  mediaSize: Size,\n  cropSize: Size,\n  zoom: number,\n  rotation = 0\n): Point {\n  const { width, height } = translateSize(mediaSize.width, mediaSize.height, rotation)\n\n  return {\n    x: restrictPositionCoord(position.x, width, cropSize.width, zoom),\n    y: restrictPositionCoord(position.y, height, cropSize.height, zoom),\n  }\n}\n\nfunction restrictPositionCoord(\n  position: number,\n  mediaSize: number,\n  cropSize: number,\n  zoom: number\n): number {\n  const maxPosition = (mediaSize * zoom) / 2 - cropSize / 2\n  return Math.min(maxPosition, Math.max(position, -maxPosition))\n}\n\nexport function getDistanceBetweenPoints(pointA: Point, pointB: Point) {\n  return Math.sqrt(Math.pow(pointA.y - pointB.y, 2) + Math.pow(pointA.x - pointB.x, 2))\n}\n\nexport function getRotationBetweenPoints(pointA: Point, pointB: Point) {\n  return (Math.atan2(pointB.y - pointA.y, pointB.x - pointA.x) * 180) / Math.PI\n}\n\n/**\n * Compute the output cropped area of the media in percentages and pixels.\n * x/y are the top-left coordinates on the src media\n */\nexport function computeCroppedArea(\n  crop: Point,\n  mediaSize: MediaSize,\n  cropSize: Size,\n  aspect: number,\n  zoom: number,\n  rotation = 0,\n  restrictPosition = true\n): { croppedAreaPercentages: Area; croppedAreaPixels: Area } {\n  // if the media is rotated by the user, we cannot limit the position anymore\n  // as it might need to be negative.\n  const limitAreaFn = restrictPosition && rotation === 0 ? limitArea : noOp\n  const croppedAreaPercentages = {\n    x: limitAreaFn(\n      100,\n      (((mediaSize.width - cropSize.width / zoom) / 2 - crop.x / zoom) / mediaSize.width) * 100\n    ),\n    y: limitAreaFn(\n      100,\n      (((mediaSize.height - cropSize.height / zoom) / 2 - crop.y / zoom) / mediaSize.height) * 100\n    ),\n    width: limitAreaFn(100, ((cropSize.width / mediaSize.width) * 100) / zoom),\n    height: limitAreaFn(100, ((cropSize.height / mediaSize.height) * 100) / zoom),\n  }\n\n  // we compute the pixels size naively\n  const widthInPixels = Math.round(\n    limitAreaFn(\n      mediaSize.naturalWidth,\n      (croppedAreaPercentages.width * mediaSize.naturalWidth) / 100\n    )\n  )\n  const heightInPixels = Math.round(\n    limitAreaFn(\n      mediaSize.naturalHeight,\n      (croppedAreaPercentages.height * mediaSize.naturalHeight) / 100\n    )\n  )\n  const isImgWiderThanHigh = mediaSize.naturalWidth >= mediaSize.naturalHeight * aspect\n\n  // then we ensure the width and height exactly match the aspect (to avoid rounding approximations)\n  // if the media is wider than high, when zoom is 0, the crop height will be equals to iamge height\n  // thus we want to compute the width from the height and aspect for accuracy.\n  // Otherwise, we compute the height from width and aspect.\n  const sizePixels = isImgWiderThanHigh\n    ? {\n        width: Math.round(heightInPixels * aspect),\n        height: heightInPixels,\n      }\n    : {\n        width: widthInPixels,\n        height: Math.round(widthInPixels / aspect),\n      }\n  const croppedAreaPixels = {\n    ...sizePixels,\n    x: Math.round(\n      limitAreaFn(\n        mediaSize.naturalWidth - sizePixels.width,\n        (croppedAreaPercentages.x * mediaSize.naturalWidth) / 100\n      )\n    ),\n    y: Math.round(\n      limitAreaFn(\n        mediaSize.naturalHeight - sizePixels.height,\n        (croppedAreaPercentages.y * mediaSize.naturalHeight) / 100\n      )\n    ),\n  }\n  return { croppedAreaPercentages, croppedAreaPixels }\n}\n\n/**\n * Ensure the returned value is between 0 and max\n */\nfunction limitArea(max: number, value: number): number {\n  return Math.min(max, Math.max(0, value))\n}\n\nfunction noOp(_max: number, value: number) {\n  return value\n}\n\n/**\n * Compute the crop and zoom from the croppedAreaPixels\n */\nfunction getZoomFromCroppedAreaPixels(\n  croppedAreaPixels: Area,\n  mediaSize: MediaSize,\n  cropSize?: Size\n): number {\n  const mediaZoom = mediaSize.width / mediaSize.naturalWidth\n\n  if (cropSize) {\n    const isHeightMaxSize = cropSize.height > cropSize.width\n    return isHeightMaxSize\n      ? cropSize.height / mediaZoom / croppedAreaPixels.height\n      : cropSize.width / mediaZoom / croppedAreaPixels.width\n  }\n\n  const aspect = croppedAreaPixels.width / croppedAreaPixels.height\n  const isHeightMaxSize = mediaSize.naturalWidth >= mediaSize.naturalHeight * aspect\n  return isHeightMaxSize\n    ? mediaSize.naturalHeight / croppedAreaPixels.height\n    : mediaSize.naturalWidth / croppedAreaPixels.width\n}\n\n/**\n * Compute the crop and zoom from the croppedAreaPixels\n */\nexport function getInitialCropFromCroppedAreaPixels(\n  croppedAreaPixels: Area,\n  mediaSize: MediaSize,\n  cropSize?: Size\n): { crop: Point; zoom: number } {\n  const mediaZoom = mediaSize.width / mediaSize.naturalWidth\n\n  const zoom = getZoomFromCroppedAreaPixels(croppedAreaPixels, mediaSize, cropSize)\n\n  const cropZoom = mediaZoom * zoom\n\n  const crop = {\n    x: ((mediaSize.naturalWidth - croppedAreaPixels.width) / 2 - croppedAreaPixels.x) * cropZoom,\n    y: ((mediaSize.naturalHeight - croppedAreaPixels.height) / 2 - croppedAreaPixels.y) * cropZoom,\n  }\n  return { crop, zoom }\n}\n\n/**\n * Return the point that is the center of point a and b\n */\nexport function getCenter(a: Point, b: Point): Point {\n  return {\n    x: (b.x + a.x) / 2,\n    y: (b.y + a.y) / 2,\n  }\n}\n\n/**\n *\n * Returns an x,y point once rotated around xMid,yMid\n */\nexport function rotateAroundMidPoint(\n  x: number,\n  y: number,\n  xMid: number,\n  yMid: number,\n  degrees: number\n): [number, number] {\n  const cos = Math.cos\n  const sin = Math.sin\n  const radian = (degrees * Math.PI) / 180 // Convert to radians\n  // Subtract midpoints, so that midpoint is translated to origin\n  // and add it in the end again\n  const xr = (x - xMid) * cos(radian) - (y - yMid) * sin(radian) + xMid\n  const yr = (x - xMid) * sin(radian) + (y - yMid) * cos(radian) + yMid\n\n  return [xr, yr]\n}\n\n/**\n * Returns the new bounding area of a rotated rectangle.\n */\nexport function translateSize(width: number, height: number, rotation: number): Size {\n  const centerX = width / 2\n  const centerY = height / 2\n\n  const outerBounds = [\n    rotateAroundMidPoint(0, 0, centerX, centerY, rotation),\n    rotateAroundMidPoint(width, 0, centerX, centerY, rotation),\n    rotateAroundMidPoint(width, height, centerX, centerY, rotation),\n    rotateAroundMidPoint(0, height, centerX, centerY, rotation),\n  ]\n\n  const minX = Math.min(...outerBounds.map(p => p[0]))\n  const maxX = Math.max(...outerBounds.map(p => p[0]))\n  const minY = Math.min(...outerBounds.map(p => p[1]))\n  const maxY = Math.max(...outerBounds.map(p => p[1]))\n\n  return { width: maxX - minX, height: maxY - minY }\n}\n\n/**\n * Combine multiple class names into a single string.\n */\nexport function classNames(...args: (boolean | string | number | undefined | void | null)[]) {\n  return args\n    .filter(value => {\n      if (typeof value === 'string' && value.length > 0) {\n        return true\n      }\n\n      return false\n    })\n    .join(' ')\n    .trim()\n}\n","import React from 'react'\nimport { Area, MediaSize, Point, Size } from './types'\nimport {\n  getCropSize,\n  restrictPosition,\n  getDistanceBetweenPoints,\n  getRotationBetweenPoints,\n  computeCroppedArea,\n  getCenter,\n  getInitialCropFromCroppedAreaPixels,\n  classNames,\n} from './helpers'\nimport cssStyles from './styles.css'\n\ntype Props = {\n  image?: string\n  video?: string\n  transform?: string\n  crop: Point\n  zoom: number\n  rotation: number\n  aspect: number\n  minZoom: number\n  maxZoom: number\n  cropShape: 'rect' | 'round'\n  cropSize?: Size\n  showGrid?: boolean\n  zoomSpeed: number\n  zoomWithScroll?: boolean\n  onCropChange: (location: Point) => void\n  onZoomChange?: (zoom: number) => void\n  onRotationChange?: (rotation: number) => void\n  onCropComplete?: (croppedArea: Area, croppedAreaPixels: Area) => void\n  onInteractionStart?: () => void\n  onInteractionEnd?: () => void\n  onMediaLoaded?: (mediaSize: MediaSize) => void\n  style: {\n    containerStyle?: React.CSSProperties\n    mediaStyle?: React.CSSProperties\n    cropAreaStyle?: React.CSSProperties\n  }\n  classes: {\n    containerClassName?: string\n    mediaClassName?: string\n    cropAreaClassName?: string\n  }\n  restrictPosition: boolean\n  initialCroppedAreaPixels?: Area\n  mediaProps: React.ImgHTMLAttributes<HTMLElement> | React.VideoHTMLAttributes<HTMLElement>\n  disableAutomaticStylesInjection?: boolean\n}\n\ntype State = {\n  cropSize: Size | null\n  hasWheelJustStarted: boolean\n}\n\nconst MIN_ZOOM = 1\nconst MAX_ZOOM = 3\n\nclass Cropper extends React.Component<Props, State> {\n  static defaultProps = {\n    zoom: 1,\n    rotation: 0,\n    aspect: 4 / 3,\n    maxZoom: MAX_ZOOM,\n    minZoom: MIN_ZOOM,\n    cropShape: 'rect',\n    showGrid: true,\n    style: {},\n    classes: {},\n    mediaProps: {},\n    zoomSpeed: 1,\n    restrictPosition: true,\n    zoomWithScroll: true,\n  }\n\n  imageRef: HTMLImageElement | null = null\n  videoRef: HTMLVideoElement | null = null\n  containerRef: HTMLDivElement | null = null\n  styleRef: HTMLStyleElement | null = null\n  containerRect: DOMRect | null = null\n  mediaSize: MediaSize = { width: 0, height: 0, naturalWidth: 0, naturalHeight: 0 }\n  dragStartPosition: Point = { x: 0, y: 0 }\n  dragStartCrop: Point = { x: 0, y: 0 }\n  lastPinchDistance = 0\n  lastPinchRotation = 0\n  rafDragTimeout: number | null = null\n  rafPinchTimeout: number | null = null\n  wheelTimer: number | null = null\n\n  state: State = {\n    cropSize: null,\n    hasWheelJustStarted: false,\n  }\n\n  componentDidMount() {\n    window.addEventListener('resize', this.computeSizes)\n    if (this.containerRef) {\n      this.props.zoomWithScroll &&\n        this.containerRef.addEventListener('wheel', this.onWheel, { passive: false })\n      this.containerRef.addEventListener('gesturestart', this.preventZoomSafari)\n      this.containerRef.addEventListener('gesturechange', this.preventZoomSafari)\n    }\n\n    if (!this.props.disableAutomaticStylesInjection) {\n      this.styleRef = document.createElement('style')\n      this.styleRef.setAttribute('type', 'text/css')\n      this.styleRef.innerHTML = cssStyles\n      document.head.appendChild(this.styleRef)\n    }\n\n    // when rendered via SSR, the image can already be loaded and its onLoad callback will never be called\n    if (this.imageRef && this.imageRef.complete) {\n      this.onMediaLoad()\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.computeSizes)\n    if (this.containerRef) {\n      this.containerRef.removeEventListener('gesturestart', this.preventZoomSafari)\n      this.containerRef.removeEventListener('gesturechange', this.preventZoomSafari)\n    }\n\n    if (this.styleRef) {\n      this.styleRef.remove()\n    }\n\n    this.cleanEvents()\n    this.props.zoomWithScroll && this.clearScrollEvent()\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.rotation !== this.props.rotation) {\n      this.computeSizes()\n      this.recomputeCropPosition()\n    } else if (prevProps.aspect !== this.props.aspect) {\n      this.computeSizes()\n    } else if (prevProps.zoom !== this.props.zoom) {\n      this.recomputeCropPosition()\n    } else if (\n      prevProps.cropSize?.height !== this.props.cropSize?.height ||\n      prevProps.cropSize?.width !== this.props.cropSize?.width\n    ) {\n      this.computeSizes()\n    }\n    if (prevProps.zoomWithScroll !== this.props.zoomWithScroll && this.containerRef) {\n      this.props.zoomWithScroll\n        ? this.containerRef.addEventListener('wheel', this.onWheel, { passive: false })\n        : this.clearScrollEvent()\n    }\n  }\n\n  // this is to prevent Safari on iOS >= 10 to zoom the page\n  preventZoomSafari = (e: Event) => e.preventDefault()\n\n  cleanEvents = () => {\n    document.removeEventListener('mousemove', this.onMouseMove)\n    document.removeEventListener('mouseup', this.onDragStopped)\n    document.removeEventListener('touchmove', this.onTouchMove)\n    document.removeEventListener('touchend', this.onDragStopped)\n  }\n\n  clearScrollEvent = () => {\n    if (this.containerRef) this.containerRef.removeEventListener('wheel', this.onWheel)\n    if (this.wheelTimer) {\n      clearTimeout(this.wheelTimer)\n    }\n  }\n\n  onMediaLoad = () => {\n    this.computeSizes()\n    this.emitCropData()\n    this.setInitialCrop()\n\n    if (this.props.onMediaLoaded) {\n      this.props.onMediaLoaded(this.mediaSize)\n    }\n  }\n\n  setInitialCrop = () => {\n    const { initialCroppedAreaPixels, cropSize } = this.props\n\n    if (!initialCroppedAreaPixels) {\n      return\n    }\n\n    const { crop, zoom } = getInitialCropFromCroppedAreaPixels(\n      initialCroppedAreaPixels,\n      this.mediaSize,\n      cropSize\n    )\n    this.props.onCropChange(crop)\n    this.props.onZoomChange && this.props.onZoomChange(zoom)\n  }\n\n  getAspect() {\n    const { cropSize, aspect } = this.props\n    if (cropSize) {\n      return cropSize.width / cropSize.height\n    }\n    return aspect\n  }\n\n  computeSizes = () => {\n    const mediaRef = this.imageRef || this.videoRef\n    if (mediaRef && this.containerRef) {\n      this.containerRect = this.containerRef.getBoundingClientRect()\n\n      this.mediaSize = {\n        width: mediaRef.offsetWidth,\n        height: mediaRef.offsetHeight,\n        naturalWidth: this.imageRef?.naturalWidth || this.videoRef?.videoWidth || 0,\n        naturalHeight: this.imageRef?.naturalHeight || this.videoRef?.videoHeight || 0,\n      }\n      const cropSize = this.props.cropSize\n        ? this.props.cropSize\n        : getCropSize(\n            mediaRef.offsetWidth,\n            mediaRef.offsetHeight,\n            this.containerRect.width,\n            this.containerRect.height,\n            this.props.aspect,\n            this.props.rotation\n          )\n      this.setState({ cropSize }, this.recomputeCropPosition)\n    }\n  }\n\n  static getMousePoint = (e: MouseEvent | React.MouseEvent) => ({\n    x: Number(e.clientX),\n    y: Number(e.clientY),\n  })\n\n  static getTouchPoint = (touch: Touch | React.Touch) => ({\n    x: Number(touch.clientX),\n    y: Number(touch.clientY),\n  })\n\n  onMouseDown = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    e.preventDefault()\n    document.addEventListener('mousemove', this.onMouseMove)\n    document.addEventListener('mouseup', this.onDragStopped)\n    this.onDragStart(Cropper.getMousePoint(e))\n  }\n\n  onMouseMove = (e: MouseEvent) => this.onDrag(Cropper.getMousePoint(e))\n\n  onTouchStart = (e: React.TouchEvent<HTMLDivElement>) => {\n    e.preventDefault()\n    document.addEventListener('touchmove', this.onTouchMove, { passive: false }) // iOS 11 now defaults to passive: true\n    document.addEventListener('touchend', this.onDragStopped)\n    if (e.touches.length === 2) {\n      this.onPinchStart(e)\n    } else if (e.touches.length === 1) {\n      this.onDragStart(Cropper.getTouchPoint(e.touches[0]))\n    }\n  }\n\n  onTouchMove = (e: TouchEvent) => {\n    // Prevent whole page from scrolling on iOS.\n    e.preventDefault()\n    if (e.touches.length === 2) {\n      this.onPinchMove(e)\n    } else if (e.touches.length === 1) {\n      this.onDrag(Cropper.getTouchPoint(e.touches[0]))\n    }\n  }\n\n  onDragStart = ({ x, y }: Point) => {\n    this.dragStartPosition = { x, y }\n    this.dragStartCrop = { ...this.props.crop }\n    this.props.onInteractionStart?.()\n  }\n\n  onDrag = ({ x, y }: Point) => {\n    if (this.rafDragTimeout) window.cancelAnimationFrame(this.rafDragTimeout)\n\n    this.rafDragTimeout = window.requestAnimationFrame(() => {\n      if (!this.state.cropSize) return\n      if (x === undefined || y === undefined) return\n      const offsetX = x - this.dragStartPosition.x\n      const offsetY = y - this.dragStartPosition.y\n      const requestedPosition = {\n        x: this.dragStartCrop.x + offsetX,\n        y: this.dragStartCrop.y + offsetY,\n      }\n\n      const newPosition = this.props.restrictPosition\n        ? restrictPosition(\n            requestedPosition,\n            this.mediaSize,\n            this.state.cropSize,\n            this.props.zoom,\n            this.props.rotation\n          )\n        : requestedPosition\n      this.props.onCropChange(newPosition)\n    })\n  }\n\n  onDragStopped = () => {\n    this.cleanEvents()\n    this.emitCropData()\n    this.props.onInteractionEnd?.()\n  }\n\n  onPinchStart(e: React.TouchEvent<HTMLDivElement>) {\n    const pointA = Cropper.getTouchPoint(e.touches[0])\n    const pointB = Cropper.getTouchPoint(e.touches[1])\n    this.lastPinchDistance = getDistanceBetweenPoints(pointA, pointB)\n    this.lastPinchRotation = getRotationBetweenPoints(pointA, pointB)\n    this.onDragStart(getCenter(pointA, pointB))\n  }\n\n  onPinchMove(e: TouchEvent) {\n    const pointA = Cropper.getTouchPoint(e.touches[0])\n    const pointB = Cropper.getTouchPoint(e.touches[1])\n    const center = getCenter(pointA, pointB)\n    this.onDrag(center)\n\n    if (this.rafPinchTimeout) window.cancelAnimationFrame(this.rafPinchTimeout)\n    this.rafPinchTimeout = window.requestAnimationFrame(() => {\n      const distance = getDistanceBetweenPoints(pointA, pointB)\n      const newZoom = this.props.zoom * (distance / this.lastPinchDistance)\n      this.setNewZoom(newZoom, center)\n      this.lastPinchDistance = distance\n\n      const rotation = getRotationBetweenPoints(pointA, pointB)\n      const newRotation = this.props.rotation + (rotation - this.lastPinchRotation)\n      this.props.onRotationChange && this.props.onRotationChange(newRotation)\n      this.lastPinchRotation = rotation\n    })\n  }\n\n  onWheel = (e: WheelEvent) => {\n    e.preventDefault()\n    const point = Cropper.getMousePoint(e)\n    const newZoom = this.props.zoom - (e.deltaY * this.props.zoomSpeed) / 200\n    this.setNewZoom(newZoom, point)\n\n    if (!this.state.hasWheelJustStarted) {\n      this.setState({ hasWheelJustStarted: true }, () => this.props.onInteractionStart?.())\n    }\n\n    if (this.wheelTimer) {\n      clearTimeout(this.wheelTimer)\n    }\n    this.wheelTimer = window.setTimeout(\n      () => this.setState({ hasWheelJustStarted: false }, () => this.props.onInteractionEnd?.()),\n      250\n    )\n  }\n\n  getPointOnContainer = ({ x, y }: Point) => {\n    if (!this.containerRect) {\n      throw new Error('The Cropper is not mounted')\n    }\n    return {\n      x: this.containerRect.width / 2 - (x - this.containerRect.left),\n      y: this.containerRect.height / 2 - (y - this.containerRect.top),\n    }\n  }\n\n  getPointOnMedia = ({ x, y }: Point) => {\n    const { crop, zoom } = this.props\n    return {\n      x: (x + crop.x) / zoom,\n      y: (y + crop.y) / zoom,\n    }\n  }\n\n  setNewZoom = (zoom: number, point: Point) => {\n    if (!this.state.cropSize || !this.props.onZoomChange) return\n\n    const zoomPoint = this.getPointOnContainer(point)\n    const zoomTarget = this.getPointOnMedia(zoomPoint)\n    const newZoom = Math.min(this.props.maxZoom, Math.max(zoom, this.props.minZoom))\n    const requestedPosition = {\n      x: zoomTarget.x * newZoom - zoomPoint.x,\n      y: zoomTarget.y * newZoom - zoomPoint.y,\n    }\n    const newPosition = this.props.restrictPosition\n      ? restrictPosition(\n          requestedPosition,\n          this.mediaSize,\n          this.state.cropSize,\n          newZoom,\n          this.props.rotation\n        )\n      : requestedPosition\n\n    this.props.onCropChange(newPosition)\n    this.props.onZoomChange(newZoom)\n  }\n\n  emitCropData = () => {\n    if (!this.state.cropSize) return\n    // this is to ensure the crop is correctly restricted after a zoom back (https://github.com/ricardo-ch/react-easy-crop/issues/6)\n    const restrictedPosition = this.props.restrictPosition\n      ? restrictPosition(\n          this.props.crop,\n          this.mediaSize,\n          this.state.cropSize,\n          this.props.zoom,\n          this.props.rotation\n        )\n      : this.props.crop\n    const { croppedAreaPercentages, croppedAreaPixels } = computeCroppedArea(\n      restrictedPosition,\n      this.mediaSize,\n      this.state.cropSize,\n      this.getAspect(),\n      this.props.zoom,\n      this.props.rotation,\n      this.props.restrictPosition\n    )\n    this.props.onCropComplete &&\n      this.props.onCropComplete(croppedAreaPercentages, croppedAreaPixels)\n  }\n\n  recomputeCropPosition = () => {\n    if (!this.state.cropSize) return\n\n    const newPosition = this.props.restrictPosition\n      ? restrictPosition(\n          this.props.crop,\n          this.mediaSize,\n          this.state.cropSize,\n          this.props.zoom,\n          this.props.rotation\n        )\n      : this.props.crop\n    this.props.onCropChange(newPosition)\n    this.emitCropData()\n  }\n\n  render() {\n    const {\n      image,\n      video,\n      mediaProps,\n      transform,\n      crop: { x, y },\n      rotation,\n      zoom,\n      cropShape,\n      showGrid,\n      style: { containerStyle, cropAreaStyle, mediaStyle },\n      classes: { containerClassName, cropAreaClassName, mediaClassName },\n    } = this.props\n\n    return (\n      <div\n        onMouseDown={this.onMouseDown}\n        onTouchStart={this.onTouchStart}\n        ref={el => (this.containerRef = el)}\n        data-testid=\"container\"\n        style={containerStyle}\n        className={classNames('reactEasyCrop_Container', containerClassName)}\n      >\n        {image ? (\n          <img\n            alt=\"\"\n            className={classNames('reactEasyCrop_Image', mediaClassName)}\n            {...(mediaProps as React.ImgHTMLAttributes<HTMLElement>)}\n            src={image}\n            ref={(el: HTMLImageElement) => (this.imageRef = el)}\n            style={{\n              ...mediaStyle,\n              transform:\n                transform || `translate(${x}px, ${y}px) rotate(${rotation}deg) scale(${zoom})`,\n            }}\n            onLoad={this.onMediaLoad}\n          />\n        ) : (\n          video && (\n            <video\n              autoPlay\n              loop\n              muted={true}\n              className={classNames('reactEasyCrop_Video', mediaClassName)}\n              {...mediaProps}\n              src={video}\n              ref={(el: HTMLVideoElement) => (this.videoRef = el)}\n              onLoadedMetadata={this.onMediaLoad}\n              style={{\n                ...mediaStyle,\n                transform:\n                  transform || `translate(${x}px, ${y}px) rotate(${rotation}deg) scale(${zoom})`,\n              }}\n              controls={false}\n            />\n          )\n        )}\n        {this.state.cropSize && (\n          <div\n            style={{\n              ...cropAreaStyle,\n              width: this.state.cropSize.width,\n              height: this.state.cropSize.height,\n            }}\n            data-testid=\"cropper\"\n            className={classNames(\n              'reactEasyCrop_CropArea',\n              cropShape === 'round' && 'reactEasyCrop_CropAreaRound',\n              showGrid && 'reactEasyCrop_CropAreaGrid',\n              cropAreaClassName\n            )}\n          />\n        )}\n      </div>\n    )\n  }\n}\n\nexport default Cropper\n"],"names":["getCropSize","mediaWidth","mediaHeight","containerWidth","containerHeight","aspect","rotation","_a","width","height","fittingWidth","Math","min","fittingHeight","restrictPosition","position","mediaSize","cropSize","zoom","x","restrictPositionCoord","y","maxPosition","max","getDistanceBetweenPoints","pointA","pointB","sqrt","pow","getRotationBetweenPoints","atan2","PI","computeCroppedArea","crop","limitAreaFn","limitArea","noOp","croppedAreaPercentages","widthInPixels","round","naturalWidth","heightInPixels","naturalHeight","isImgWiderThanHigh","sizePixels","croppedAreaPixels","value","_max","getZoomFromCroppedAreaPixels","mediaZoom","isHeightMaxSize_1","isHeightMaxSize","getInitialCropFromCroppedAreaPixels","cropZoom","getCenter","a","b","rotateAroundMidPoint","xMid","yMid","degrees","cos","sin","radian","xr","yr","translateSize","centerX","centerY","outerBounds","minX","map","p","maxX","minY","maxY","classNames","_i","args","filter","length","join","trim","MIN_ZOOM","MAX_ZOOM","__extends","_this","hasWheelJustStarted","e","preventDefault","document","removeEventListener","onMouseMove","onDragStopped","onTouchMove","containerRef","onWheel","wheelTimer","clearTimeout","computeSizes","emitCropData","setInitialCrop","props","onMediaLoaded","initialCroppedAreaPixels","_b","onCropChange","onZoomChange","mediaRef","imageRef","videoRef","containerRect","getBoundingClientRect","offsetWidth","offsetHeight","videoWidth","videoHeight","setState","recomputeCropPosition","addEventListener","onDragStart","Cropper","getMousePoint","onDrag","passive","touches","onPinchStart","getTouchPoint","onPinchMove","dragStartPosition","dragStartCrop","onInteractionStart","rafDragTimeout","window","cancelAnimationFrame","requestAnimationFrame","state","undefined","offsetX","offsetY","requestedPosition","newPosition","cleanEvents","onInteractionEnd","point","newZoom","deltaY","zoomSpeed","setNewZoom","setTimeout","Error","left","top","zoomPoint","getPointOnContainer","zoomTarget","getPointOnMedia","maxZoom","minZoom","restrictedPosition","onCropComplete","zoomWithScroll","preventZoomSafari","disableAutomaticStylesInjection","styleRef","createElement","setAttribute","innerHTML","cssStyles","head","appendChild","complete","onMediaLoad","remove","clearScrollEvent","prevProps","lastPinchDistance","lastPinchRotation","center","rafPinchTimeout","distance","newRotation","onRotationChange","image","video","mediaProps","transform","cropShape","showGrid","_c","containerStyle","cropAreaStyle","mediaStyle","_d","containerClassName","cropAreaClassName","mediaClassName","React","onMouseDown","onTouchStart","ref","el","style","className","alt","src","onLoad","autoPlay","loop","muted","onLoadedMetadata","controls","classes","Number","clientX","clientY","touch","Component"],"mappings":"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"}