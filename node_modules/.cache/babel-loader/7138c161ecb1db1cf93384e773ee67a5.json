{"ast":null,"code":"var _jsxFileName = \"/Users/robertocandales/Documents/ecommerce/frontend/src/Components/global/Upload/UploadProduct.js\";\nimport React, { useState } from 'react';\nimport axios from 'axios';\nimport { Upload, Progress } from 'antd';\nimport Notification from '../../global/Notification';\nimport './styles.css';\nimport { URLbase } from '../../../Api/URLbase';\nimport { useSelector } from 'react-redux';\n\nconst UploadProduct = ({\n  fileList,\n  setFileList,\n  setHhumbUrl,\n  thumbUrl,\n  edit = false\n}) => {\n  const {\n    token\n  } = useSelector(store => store.login.login);\n  const [defaultFileList, setDefaultFileList] = useState([{\n    percent: 100,\n    size: 221700,\n    status: 'uploading',\n    thumbUrl: thumbUrl,\n    type: 'image/png',\n    uid: Math.random() + 100\n  }]);\n  const [progress, setProgress] = useState(0);\n\n  const uploadImage = async options => {\n    const {\n      onSuccess,\n      onError,\n      file,\n      onProgress\n    } = options;\n    const formData = new FormData();\n    console.log(file, 'file');\n    const config = {\n      headers: {\n        'content-type': 'multipart/form-data',\n        'X-Auth-Token': token\n      },\n      onUploadProgress: event => {\n        const percent = Math.floor(event.loaded / event.total * 100);\n        setProgress(percent);\n\n        if (percent === 100) {\n          setTimeout(() => setProgress(0), 1000);\n        }\n\n        onProgress({\n          percent: event.loaded / event.total * 100\n        });\n      }\n    };\n    formData.append('file', file);\n\n    try {\n      const res = await axios.post(`${URLbase}/api/products/upload`, formData, config);\n\n      if (!res.data.error) {\n        Notification({\n          message: 'Imagen Cargada',\n          type: 'success'\n        });\n        setFileList(res.data.filename);\n        onSuccess('Ok');\n      } else {\n        if (res.data.error === 'No token, authorization denied') {\n          Notification({\n            message: 'Debe iniciar sesion para cargar la imagen',\n            type: 'error'\n          });\n        }\n\n        if (res.data.error === 'Token is no valid') {\n          Notification({\n            message: 'Problemas de inicio de sesion, debe inicar sesion nuevamente',\n            type: 'error'\n          });\n        }\n      }\n\n      console.log('server res: ', res);\n    } catch (err) {\n      console.log('Eroor: ', err);\n      const error = new Error('Some error');\n      onError({\n        err\n      });\n    }\n  };\n\n  const handleOnChange = ({\n    file,\n    fileList,\n    event\n  }) => {\n    setDefaultFileList(fileList);\n    setHhumbUrl(fileList[0]);\n    console.log(fileList);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Upload, {\n    type: \"file\",\n    name: \"file\",\n    accept: \"image/*\",\n    customRequest: uploadImage,\n    onChange: handleOnChange,\n    listType: \"picture-card\",\n    defaultFileList: defaultFileList,\n    className: \"image-upload-grid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, defaultFileList.length >= 1 ? null : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 49\n    }\n  }, \"Upload Button\")), progress > 0 ? /*#__PURE__*/React.createElement(Progress, {\n    percent: progress,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 25\n    }\n  }) : null));\n};\n\nexport default UploadProduct;","map":{"version":3,"sources":["/Users/robertocandales/Documents/ecommerce/frontend/src/Components/global/Upload/UploadProduct.js"],"names":["React","useState","axios","Upload","Progress","Notification","URLbase","useSelector","UploadProduct","fileList","setFileList","setHhumbUrl","thumbUrl","edit","token","store","login","defaultFileList","setDefaultFileList","percent","size","status","type","uid","Math","random","progress","setProgress","uploadImage","options","onSuccess","onError","file","onProgress","formData","FormData","console","log","config","headers","onUploadProgress","event","floor","loaded","total","setTimeout","append","res","post","data","error","message","filename","err","Error","handleOnChange","length"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,EAAiBC,QAAjB,QAAiC,MAAjC;AACA,OAAOC,YAAP,MAAyB,2BAAzB;AACA,OAAO,cAAP;AACA,SAASC,OAAT,QAAwB,sBAAxB;AACA,SAASC,WAAT,QAA4B,aAA5B;;AAEA,MAAMC,aAAa,GAAG,CAAC;AAAEC,EAAAA,QAAF;AAAYC,EAAAA,WAAZ;AAAyBC,EAAAA,WAAzB;AAAsCC,EAAAA,QAAtC;AAAgDC,EAAAA,IAAI,GAAG;AAAvD,CAAD,KAAoE;AACxF,QAAM;AAAEC,IAAAA;AAAF,MAAYP,WAAW,CAAEQ,KAAD,IAAWA,KAAK,CAACC,KAAN,CAAYA,KAAxB,CAA7B;AACA,QAAM,CAACC,eAAD,EAAkBC,kBAAlB,IAAwCjB,QAAQ,CAAC,CACrD;AACEkB,IAAAA,OAAO,EAAE,GADX;AAEEC,IAAAA,IAAI,EAAE,MAFR;AAGEC,IAAAA,MAAM,EAAE,WAHV;AAIET,IAAAA,QAAQ,EAAEA,QAJZ;AAKEU,IAAAA,IAAI,EAAE,WALR;AAMEC,IAAAA,GAAG,EAAEC,IAAI,CAACC,MAAL,KAAgB;AANvB,GADqD,CAAD,CAAtD;AAUA,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0B1B,QAAQ,CAAC,CAAD,CAAxC;;AAEA,QAAM2B,WAAW,GAAG,MAAOC,OAAP,IAAmB;AACrC,UAAM;AAAEC,MAAAA,SAAF;AAAaC,MAAAA,OAAb;AAAsBC,MAAAA,IAAtB;AAA4BC,MAAAA;AAA5B,QAA2CJ,OAAjD;AACA,UAAMK,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYL,IAAZ,EAAkB,MAAlB;AACA,UAAMM,MAAM,GAAG;AACbC,MAAAA,OAAO,EAAE;AAAE,wBAAgB,qBAAlB;AAAyC,wBAAgBzB;AAAzD,OADI;AAEb0B,MAAAA,gBAAgB,EAAGC,KAAD,IAAW;AAC3B,cAAMtB,OAAO,GAAGK,IAAI,CAACkB,KAAL,CAAYD,KAAK,CAACE,MAAN,GAAeF,KAAK,CAACG,KAAtB,GAA+B,GAA1C,CAAhB;AACAjB,QAAAA,WAAW,CAACR,OAAD,CAAX;;AACA,YAAIA,OAAO,KAAK,GAAhB,EAAqB;AACnB0B,UAAAA,UAAU,CAAC,MAAMlB,WAAW,CAAC,CAAD,CAAlB,EAAuB,IAAvB,CAAV;AACD;;AACDM,QAAAA,UAAU,CAAC;AAAEd,UAAAA,OAAO,EAAGsB,KAAK,CAACE,MAAN,GAAeF,KAAK,CAACG,KAAtB,GAA+B;AAA1C,SAAD,CAAV;AACD;AATY,KAAf;AAWAV,IAAAA,QAAQ,CAACY,MAAT,CAAgB,MAAhB,EAAwBd,IAAxB;;AAEA,QAAI;AACF,YAAMe,GAAG,GAAG,MAAM7C,KAAK,CAAC8C,IAAN,CAAY,GAAE1C,OAAQ,sBAAtB,EAA6C4B,QAA7C,EAAuDI,MAAvD,CAAlB;;AACA,UAAI,CAACS,GAAG,CAACE,IAAJ,CAASC,KAAd,EAAqB;AACnB7C,QAAAA,YAAY,CAAC;AACX8C,UAAAA,OAAO,EAAE,gBADE;AAEX7B,UAAAA,IAAI,EAAE;AAFK,SAAD,CAAZ;AAIAZ,QAAAA,WAAW,CAACqC,GAAG,CAACE,IAAJ,CAASG,QAAV,CAAX;AACAtB,QAAAA,SAAS,CAAC,IAAD,CAAT;AACD,OAPD,MAOO;AACL,YAAIiB,GAAG,CAACE,IAAJ,CAASC,KAAT,KAAmB,gCAAvB,EAAyD;AACvD7C,UAAAA,YAAY,CAAC;AACX8C,YAAAA,OAAO,EAAE,2CADE;AAEX7B,YAAAA,IAAI,EAAE;AAFK,WAAD,CAAZ;AAID;;AACD,YAAIyB,GAAG,CAACE,IAAJ,CAASC,KAAT,KAAmB,mBAAvB,EAA4C;AAC1C7C,UAAAA,YAAY,CAAC;AACX8C,YAAAA,OAAO,EAAE,8DADE;AAEX7B,YAAAA,IAAI,EAAE;AAFK,WAAD,CAAZ;AAID;AACF;;AAEDc,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BU,GAA5B;AACD,KAzBD,CAyBE,OAAOM,GAAP,EAAY;AACZjB,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBgB,GAAvB;AACA,YAAMH,KAAK,GAAG,IAAII,KAAJ,CAAU,YAAV,CAAd;AACAvB,MAAAA,OAAO,CAAC;AAAEsB,QAAAA;AAAF,OAAD,CAAP;AACD;AACF,GA/CD;;AAiDA,QAAME,cAAc,GAAG,CAAC;AAAEvB,IAAAA,IAAF;AAAQvB,IAAAA,QAAR;AAAkBgC,IAAAA;AAAlB,GAAD,KAA+B;AACpDvB,IAAAA,kBAAkB,CAACT,QAAD,CAAlB;AACAE,IAAAA,WAAW,CAACF,QAAQ,CAAC,CAAD,CAAT,CAAX;AACA2B,IAAAA,OAAO,CAACC,GAAR,CAAY5B,QAAZ;AACD,GAJD;;AAMA,sBACE,uDACE;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AACE,IAAA,IAAI,EAAC,MADP;AAEE,IAAA,IAAI,EAAC,MAFP;AAGE,IAAA,MAAM,EAAC,SAHT;AAIE,IAAA,aAAa,EAAEmB,WAJjB;AAKE,IAAA,QAAQ,EAAE2B,cALZ;AAME,IAAA,QAAQ,EAAC,cANX;AAOE,IAAA,eAAe,EAAEtC,eAPnB;AAQE,IAAA,SAAS,EAAC,mBARZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASGA,eAAe,CAACuC,MAAhB,IAA0B,CAA1B,GAA8B,IAA9B,gBAAqC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBATxC,CADF,EAYG9B,QAAQ,GAAG,CAAX,gBAAe,oBAAC,QAAD;AAAU,IAAA,OAAO,EAAEA,QAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAf,GAAiD,IAZpD,CADF,CADF;AAkBD,CAvFD;;AAyFA,eAAelB,aAAf","sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport { Upload, Progress } from 'antd';\nimport Notification from '../../global/Notification';\nimport './styles.css';\nimport { URLbase } from '../../../Api/URLbase';\nimport { useSelector } from 'react-redux';\n\nconst UploadProduct = ({ fileList, setFileList, setHhumbUrl, thumbUrl, edit = false }) => {\n  const { token } = useSelector((store) => store.login.login);\n  const [defaultFileList, setDefaultFileList] = useState([\n    {\n      percent: 100,\n      size: 221700,\n      status: 'uploading',\n      thumbUrl: thumbUrl,\n      type: 'image/png',\n      uid: Math.random() + 100,\n    },\n  ]);\n  const [progress, setProgress] = useState(0);\n\n  const uploadImage = async (options) => {\n    const { onSuccess, onError, file, onProgress } = options;\n    const formData = new FormData();\n    console.log(file, 'file');\n    const config = {\n      headers: { 'content-type': 'multipart/form-data', 'X-Auth-Token': token },\n      onUploadProgress: (event) => {\n        const percent = Math.floor((event.loaded / event.total) * 100);\n        setProgress(percent);\n        if (percent === 100) {\n          setTimeout(() => setProgress(0), 1000);\n        }\n        onProgress({ percent: (event.loaded / event.total) * 100 });\n      },\n    };\n    formData.append('file', file);\n\n    try {\n      const res = await axios.post(`${URLbase}/api/products/upload`, formData, config);\n      if (!res.data.error) {\n        Notification({\n          message: 'Imagen Cargada',\n          type: 'success',\n        });\n        setFileList(res.data.filename);\n        onSuccess('Ok');\n      } else {\n        if (res.data.error === 'No token, authorization denied') {\n          Notification({\n            message: 'Debe iniciar sesion para cargar la imagen',\n            type: 'error',\n          });\n        }\n        if (res.data.error === 'Token is no valid') {\n          Notification({\n            message: 'Problemas de inicio de sesion, debe inicar sesion nuevamente',\n            type: 'error',\n          });\n        }\n      }\n\n      console.log('server res: ', res);\n    } catch (err) {\n      console.log('Eroor: ', err);\n      const error = new Error('Some error');\n      onError({ err });\n    }\n  };\n\n  const handleOnChange = ({ file, fileList, event }) => {\n    setDefaultFileList(fileList);\n    setHhumbUrl(fileList[0]);\n    console.log(fileList);\n  };\n\n  return (\n    <>\n      <div className='container'>\n        <Upload\n          type='file'\n          name='file'\n          accept='image/*'\n          customRequest={uploadImage}\n          onChange={handleOnChange}\n          listType='picture-card'\n          defaultFileList={defaultFileList}\n          className='image-upload-grid'>\n          {defaultFileList.length >= 1 ? null : <div>Upload Button</div>}\n        </Upload>\n        {progress > 0 ? <Progress percent={progress} /> : null}\n      </div>\n    </>\n  );\n};\n\nexport default UploadProduct;\n"]},"metadata":{},"sourceType":"module"}