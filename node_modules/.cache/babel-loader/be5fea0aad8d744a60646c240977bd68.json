{"ast":null,"code":"function __$styleInject(css) {\n  if (!css) return;\n  if (typeof window == 'undefined') return;\n  var style = document.createElement('style');\n  style.setAttribute('media', 'screen');\n  style.innerHTML = css;\n  document.head.appendChild(style);\n  return css;\n}\n\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport _asyncToGenerator from '@babel/runtime/helpers/esm/asyncToGenerator';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport React, { forwardRef, useState, useRef, useCallback } from 'react';\nimport t from 'prop-types';\nimport Cropper from 'react-easy-crop';\nimport LocaleReceiver from 'antd/es/locale-provider/LocaleReceiver';\nimport Modal from 'antd/es/modal';\nimport Slider from 'antd/es/slider';\n\n__$styleInject(\".antd-img-crop-modal .ant-modal-body {\\n  padding-bottom: 16px;\\n}\\n.antd-img-crop-modal .antd-img-crop-container {\\n  position: relative;\\n  width: 100%;\\n  height: 40vh;\\n  margin-bottom: 16px;\\n}\\n.antd-img-crop-modal .antd-img-crop-control {\\n  display: flex;\\n  align-items: center;\\n  width: 60%;\\n  margin-left: auto;\\n  margin-right: auto;\\n}\\n.antd-img-crop-modal .antd-img-crop-control button {\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  width: 34px;\\n  height: 34px;\\n  padding: 0;\\n  font-style: normal;\\n  background: transparent;\\n  border: 0;\\n  outline: 0;\\n  cursor: pointer;\\n}\\n.antd-img-crop-modal .antd-img-crop-control button[disabled] {\\n  cursor: default;\\n}\\n.antd-img-crop-modal .antd-img-crop-control.zoom button {\\n  font-size: 18px;\\n}\\n.antd-img-crop-modal .antd-img-crop-control.rotate button {\\n  font-size: 16px;\\n}\\n.antd-img-crop-modal .antd-img-crop-control.rotate button:first-of-type {\\n  transform: rotate(-20deg);\\n}\\n.antd-img-crop-modal .antd-img-crop-control.rotate button:last-of-type {\\n  transform: rotate(20deg);\\n}\\n.antd-img-crop-modal .antd-img-crop-control .ant-slider {\\n  flex: 1;\\n  margin: 0 8px;\\n}\\n\");\n\nvar pkg = 'antd-img-crop';\n\nvar noop = function noop() {};\n\nvar MEDIA_CLASS = pkg + \"-media\";\nvar MODAL_TITLE = 'Edit image';\nvar MIN_ZOOM = 1;\nvar MAX_ZOOM = 3;\nvar ZOOM_STEP = 0.1;\nvar MIN_ROTATE = 0;\nvar MAX_ROTATE = 360;\nvar ROTATE_STEP = 1;\nvar EasyCrop = /*#__PURE__*/forwardRef(function (props, ref) {\n  var src = props.src,\n      aspect = props.aspect,\n      shape = props.shape,\n      grid = props.grid,\n      hasZoom = props.hasZoom,\n      zoomVal = props.zoomVal,\n      rotateVal = props.rotateVal,\n      setZoomVal = props.setZoomVal,\n      setRotateVal = props.setRotateVal,\n      onComplete = props.onComplete;\n\n  var _useState = useState({\n    x: 0,\n    y: 0\n  }),\n      crop = _useState[0],\n      setCrop = _useState[1];\n\n  var onCropComplete = useCallback(function (croppedArea, croppedAreaPixels) {\n    onComplete(croppedAreaPixels);\n  }, [onComplete]);\n  return /*#__PURE__*/React.createElement(Cropper, {\n    ref: ref,\n    image: src,\n    aspect: aspect,\n    cropShape: shape,\n    showGrid: grid,\n    zoomWithScroll: hasZoom,\n    crop: crop,\n    zoom: zoomVal,\n    rotation: rotateVal,\n    onCropChange: setCrop,\n    onZoomChange: setZoomVal,\n    onRotationChange: setRotateVal,\n    onCropComplete: onCropComplete,\n    classes: {\n      containerClassName: pkg + \"-container\",\n      mediaClassName: MEDIA_CLASS\n    }\n  });\n});\nEasyCrop.propTypes = {\n  src: t.string,\n  aspect: t.number,\n  shape: t.string,\n  grid: t.bool,\n  hasZoom: t.bool,\n  zoomVal: t.number,\n  rotateVal: t.number,\n  setZoomVal: t.func,\n  setRotateVal: t.func,\n  onComplete: t.func\n};\nvar ImgCrop = /*#__PURE__*/forwardRef(function (props, ref) {\n  var aspect = props.aspect,\n      shape = props.shape,\n      grid = props.grid,\n      zoom = props.zoom,\n      rotate = props.rotate,\n      beforeCrop = props.beforeCrop,\n      modalTitle = props.modalTitle,\n      modalWidth = props.modalWidth,\n      modalOk = props.modalOk,\n      modalCancel = props.modalCancel,\n      children = props.children;\n  var hasZoom = zoom === true;\n  var hasRotate = rotate === true;\n  var modalTextProps = {\n    okText: modalOk,\n    cancelText: modalCancel\n  };\n  Object.keys(modalTextProps).forEach(function (key) {\n    if (!modalTextProps[key]) delete modalTextProps[key];\n  });\n\n  var _useState2 = useState(''),\n      src = _useState2[0],\n      setSrc = _useState2[1];\n\n  var _useState3 = useState(1),\n      zoomVal = _useState3[0],\n      setZoomVal = _useState3[1];\n\n  var _useState4 = useState(0),\n      rotateVal = _useState4[0],\n      setRotateVal = _useState4[1];\n\n  var beforeUploadRef = useRef();\n  var fileRef = useRef();\n  var resolveRef = useRef(noop);\n  var rejectRef = useRef(noop);\n  var cropPixelsRef = useRef();\n  /**\n   * Upload\n   */\n\n  var renderUpload = useCallback(function () {\n    var upload = Array.isArray(children) ? children[0] : children;\n\n    var _upload$props = upload.props,\n        beforeUpload = _upload$props.beforeUpload,\n        accept = _upload$props.accept,\n        restUploadProps = _objectWithoutPropertiesLoose(_upload$props, [\"beforeUpload\", \"accept\"]);\n\n    beforeUploadRef.current = beforeUpload;\n    return _extends({}, upload, {\n      props: _extends({}, restUploadProps, {\n        accept: accept || 'image/*',\n        beforeUpload: function beforeUpload(file, fileList) {\n          return new Promise(function (resolve, reject) {\n            if (beforeCrop && !beforeCrop(file, fileList)) {\n              reject();\n              return;\n            }\n\n            fileRef.current = file;\n            resolveRef.current = resolve;\n            rejectRef.current = reject;\n            var reader = new FileReader();\n            reader.addEventListener('load', function () {\n              setSrc(reader.result);\n            });\n            reader.readAsDataURL(file);\n          });\n        }\n      })\n    });\n  }, [beforeCrop, children]);\n  /**\n   * EasyCrop\n   */\n\n  var onComplete = useCallback(function (croppedAreaPixels) {\n    cropPixelsRef.current = croppedAreaPixels;\n  }, []);\n  /**\n   * Controls\n   */\n\n  var isMinZoom = zoomVal === MIN_ZOOM;\n  var isMaxZoom = zoomVal === MAX_ZOOM;\n  var isMinRotate = rotateVal === MIN_ROTATE;\n  var isMaxRotate = rotateVal === MAX_ROTATE;\n  var subZoomVal = useCallback(function () {\n    if (!isMinZoom) setZoomVal(zoomVal - ZOOM_STEP);\n  }, [isMinZoom, zoomVal]);\n  var addZoomVal = useCallback(function () {\n    if (!isMaxZoom) setZoomVal(zoomVal + ZOOM_STEP);\n  }, [isMaxZoom, zoomVal]);\n  var subRotateVal = useCallback(function () {\n    if (!isMinRotate) setRotateVal(rotateVal - ROTATE_STEP);\n  }, [isMinRotate, rotateVal]);\n  var addRotateVal = useCallback(function () {\n    if (!isMaxRotate) setRotateVal(rotateVal + ROTATE_STEP);\n  }, [isMaxRotate, rotateVal]);\n  /**\n   * Modal\n   */\n\n  var onClose = useCallback(function () {\n    setSrc('');\n    setZoomVal(1);\n    setRotateVal(0);\n  }, []);\n  var onOk = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    var naturalImg, naturalWidth, naturalHeight, canvas, ctx, maxLen, halfMax, left, top, maxImgData, _cropPixelsRef$curren, width, height, x, y, _fileRef$current, type, name, uid;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            onClose();\n            naturalImg = document.querySelector(\".\" + MEDIA_CLASS);\n            naturalWidth = naturalImg.naturalWidth, naturalHeight = naturalImg.naturalHeight;\n            canvas = document.createElement('canvas');\n            ctx = canvas.getContext('2d'); // create a max canvas to cover the source image after rotated\n\n            maxLen = Math.sqrt(Math.pow(naturalWidth, 2) + Math.pow(naturalHeight, 2));\n            canvas.width = maxLen;\n            canvas.height = maxLen; // rotate the image\n\n            if (hasRotate && rotateVal > 0 && rotateVal < 360) {\n              halfMax = maxLen / 2;\n              ctx.translate(halfMax, halfMax);\n              ctx.rotate(rotateVal * Math.PI / 180);\n              ctx.translate(-halfMax, -halfMax);\n            } // draw the source image in the center of the max canvas\n\n\n            left = (maxLen - naturalWidth) / 2;\n            top = (maxLen - naturalHeight) / 2;\n            ctx.drawImage(naturalImg, left, top); // shrink the max canvas to the crop area size, then align two center points\n\n            maxImgData = ctx.getImageData(0, 0, maxLen, maxLen);\n            _cropPixelsRef$curren = cropPixelsRef.current, width = _cropPixelsRef$curren.width, height = _cropPixelsRef$curren.height, x = _cropPixelsRef$curren.x, y = _cropPixelsRef$curren.y;\n            canvas.width = width;\n            canvas.height = height;\n            ctx.putImageData(maxImgData, Math.round(-left - x), Math.round(-top - y)); // get the new image\n\n            _fileRef$current = fileRef.current, type = _fileRef$current.type, name = _fileRef$current.name, uid = _fileRef$current.uid;\n            canvas.toBlob( /*#__PURE__*/function () {\n              var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(blob) {\n                var newFile, res, passedFile, _type;\n\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        newFile = blob;\n                        newFile.lastModifiedDate = Date.now();\n                        newFile.name = name;\n                        newFile.uid = uid;\n\n                        if (!(typeof beforeUploadRef.current !== 'function')) {\n                          _context.next = 6;\n                          break;\n                        }\n\n                        return _context.abrupt(\"return\", resolveRef.current(newFile));\n\n                      case 6:\n                        res = beforeUploadRef.current(newFile, [newFile]);\n\n                        if (!(typeof res !== 'boolean' && !res)) {\n                          _context.next = 10;\n                          break;\n                        }\n\n                        console.error('beforeUpload must return a boolean or Promise');\n                        return _context.abrupt(\"return\");\n\n                      case 10:\n                        if (!(res === true)) {\n                          _context.next = 12;\n                          break;\n                        }\n\n                        return _context.abrupt(\"return\", resolveRef.current(newFile));\n\n                      case 12:\n                        if (!(res === false)) {\n                          _context.next = 14;\n                          break;\n                        }\n\n                        return _context.abrupt(\"return\", rejectRef.current('not upload'));\n\n                      case 14:\n                        if (!(res && typeof res.then === 'function')) {\n                          _context.next = 27;\n                          break;\n                        }\n\n                        _context.prev = 15;\n                        _context.next = 18;\n                        return res;\n\n                      case 18:\n                        passedFile = _context.sent;\n                        _type = Object.prototype.toString.call(passedFile);\n                        if (_type === '[object File]' || _type === '[object Blob]') newFile = passedFile;\n                        resolveRef.current(newFile);\n                        _context.next = 27;\n                        break;\n\n                      case 24:\n                        _context.prev = 24;\n                        _context.t0 = _context[\"catch\"](15);\n                        rejectRef.current(_context.t0);\n\n                      case 27:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee, null, [[15, 24]]);\n              }));\n\n              return function (_x) {\n                return _ref2.apply(this, arguments);\n              };\n            }(), type, 0.4);\n\n          case 19:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  })), [hasRotate, onClose, rotateVal]);\n  return /*#__PURE__*/React.createElement(LocaleReceiver, null, function (locale, localeCode) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, renderUpload(), src && /*#__PURE__*/React.createElement(Modal, Object.assign({\n      visible: true,\n      wrapClassName: pkg + \"-modal\",\n      title: localeCode === 'zh-cn' && modalTitle === MODAL_TITLE ? '编辑图片' : modalTitle,\n      width: modalWidth,\n      onOk: onOk,\n      onCancel: onClose,\n      maskClosable: false,\n      destroyOnClose: true\n    }, modalTextProps), /*#__PURE__*/React.createElement(EasyCrop, {\n      ref: ref,\n      src: src,\n      aspect: aspect,\n      shape: shape,\n      grid: grid,\n      hasZoom: hasZoom,\n      zoomVal: zoomVal,\n      rotateVal: rotateVal,\n      setZoomVal: setZoomVal,\n      setRotateVal: setRotateVal,\n      onComplete: onComplete\n    }), hasZoom && /*#__PURE__*/React.createElement(\"div\", {\n      className: pkg + \"-control zoom\"\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: subZoomVal,\n      disabled: isMinZoom\n    }, \"\\uFF0D\"), /*#__PURE__*/React.createElement(Slider, {\n      min: MIN_ZOOM,\n      max: MAX_ZOOM,\n      step: ZOOM_STEP,\n      value: zoomVal,\n      onChange: setZoomVal\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: addZoomVal,\n      disabled: isMaxZoom\n    }, \"\\uFF0B\")), hasRotate && /*#__PURE__*/React.createElement(\"div\", {\n      className: pkg + \"-control rotate\"\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: subRotateVal,\n      disabled: isMinRotate\n    }, \"\\u21BA\"), /*#__PURE__*/React.createElement(Slider, {\n      min: MIN_ROTATE,\n      max: MAX_ROTATE,\n      step: ROTATE_STEP,\n      value: rotateVal,\n      onChange: setRotateVal\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: addRotateVal,\n      disabled: isMaxRotate\n    }, \"\\u21BB\"))));\n  });\n});\nImgCrop.propTypes = {\n  aspect: t.number,\n  shape: t.oneOf(['rect', 'round']),\n  zoom: t.bool,\n  grid: t.bool,\n  rotate: t.bool,\n  beforeCrop: t.func,\n  modalTitle: t.string,\n  modalWidth: t.oneOfType([t.number, t.string]),\n  modalOk: t.string,\n  modalCancel: t.string,\n  children: t.node\n};\nImgCrop.defaultProps = {\n  aspect: 1,\n  shape: 'rect',\n  grid: false,\n  zoom: true,\n  rotate: false,\n  modalTitle: MODAL_TITLE,\n  modalWidth: 520\n};\nexport default ImgCrop;","map":{"version":3,"sources":["/Users/robertocandales/Documents/ecommerce/frontend/node_modules/antd-img-crop/dist/antd-img-crop.esm.js"],"names":["__$styleInject","css","window","style","document","createElement","setAttribute","innerHTML","head","appendChild","_regeneratorRuntime","_asyncToGenerator","_extends","_objectWithoutPropertiesLoose","React","forwardRef","useState","useRef","useCallback","t","Cropper","LocaleReceiver","Modal","Slider","pkg","noop","MEDIA_CLASS","MODAL_TITLE","MIN_ZOOM","MAX_ZOOM","ZOOM_STEP","MIN_ROTATE","MAX_ROTATE","ROTATE_STEP","EasyCrop","props","ref","src","aspect","shape","grid","hasZoom","zoomVal","rotateVal","setZoomVal","setRotateVal","onComplete","_useState","x","y","crop","setCrop","onCropComplete","croppedArea","croppedAreaPixels","image","cropShape","showGrid","zoomWithScroll","zoom","rotation","onCropChange","onZoomChange","onRotationChange","classes","containerClassName","mediaClassName","propTypes","string","number","bool","func","ImgCrop","rotate","beforeCrop","modalTitle","modalWidth","modalOk","modalCancel","children","hasRotate","modalTextProps","okText","cancelText","Object","keys","forEach","key","_useState2","setSrc","_useState3","_useState4","beforeUploadRef","fileRef","resolveRef","rejectRef","cropPixelsRef","renderUpload","upload","Array","isArray","_upload$props","beforeUpload","accept","restUploadProps","current","file","fileList","Promise","resolve","reject","reader","FileReader","addEventListener","result","readAsDataURL","isMinZoom","isMaxZoom","isMinRotate","isMaxRotate","subZoomVal","addZoomVal","subRotateVal","addRotateVal","onClose","onOk","mark","_callee2","naturalImg","naturalWidth","naturalHeight","canvas","ctx","maxLen","halfMax","left","top","maxImgData","_cropPixelsRef$curren","width","height","_fileRef$current","type","name","uid","wrap","_callee2$","_context2","prev","next","querySelector","getContext","Math","sqrt","pow","translate","PI","drawImage","getImageData","putImageData","round","toBlob","_ref2","_callee","blob","newFile","res","passedFile","_type","_callee$","_context","lastModifiedDate","Date","now","abrupt","console","error","then","sent","prototype","toString","call","t0","stop","_x","apply","arguments","locale","localeCode","Fragment","assign","visible","wrapClassName","title","onCancel","maskClosable","destroyOnClose","className","onClick","disabled","min","max","step","value","onChange","oneOf","oneOfType","node","defaultProps"],"mappings":"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","sourcesContent":["function __$styleInject(css) {\n    if (!css) return;\n\n    if (typeof window == 'undefined') return;\n    var style = document.createElement('style');\n    style.setAttribute('media', 'screen');\n\n    style.innerHTML = css;\n    document.head.appendChild(style);\n    return css;\n}\n\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport _asyncToGenerator from '@babel/runtime/helpers/esm/asyncToGenerator';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\nimport React, { forwardRef, useState, useRef, useCallback } from 'react';\nimport t from 'prop-types';\nimport Cropper from 'react-easy-crop';\nimport LocaleReceiver from 'antd/es/locale-provider/LocaleReceiver';\nimport Modal from 'antd/es/modal';\nimport Slider from 'antd/es/slider';\n\n__$styleInject(\".antd-img-crop-modal .ant-modal-body {\\n  padding-bottom: 16px;\\n}\\n.antd-img-crop-modal .antd-img-crop-container {\\n  position: relative;\\n  width: 100%;\\n  height: 40vh;\\n  margin-bottom: 16px;\\n}\\n.antd-img-crop-modal .antd-img-crop-control {\\n  display: flex;\\n  align-items: center;\\n  width: 60%;\\n  margin-left: auto;\\n  margin-right: auto;\\n}\\n.antd-img-crop-modal .antd-img-crop-control button {\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n  width: 34px;\\n  height: 34px;\\n  padding: 0;\\n  font-style: normal;\\n  background: transparent;\\n  border: 0;\\n  outline: 0;\\n  cursor: pointer;\\n}\\n.antd-img-crop-modal .antd-img-crop-control button[disabled] {\\n  cursor: default;\\n}\\n.antd-img-crop-modal .antd-img-crop-control.zoom button {\\n  font-size: 18px;\\n}\\n.antd-img-crop-modal .antd-img-crop-control.rotate button {\\n  font-size: 16px;\\n}\\n.antd-img-crop-modal .antd-img-crop-control.rotate button:first-of-type {\\n  transform: rotate(-20deg);\\n}\\n.antd-img-crop-modal .antd-img-crop-control.rotate button:last-of-type {\\n  transform: rotate(20deg);\\n}\\n.antd-img-crop-modal .antd-img-crop-control .ant-slider {\\n  flex: 1;\\n  margin: 0 8px;\\n}\\n\");\n\nvar pkg = 'antd-img-crop';\n\nvar noop = function noop() {};\n\nvar MEDIA_CLASS = pkg + \"-media\";\nvar MODAL_TITLE = 'Edit image';\nvar MIN_ZOOM = 1;\nvar MAX_ZOOM = 3;\nvar ZOOM_STEP = 0.1;\nvar MIN_ROTATE = 0;\nvar MAX_ROTATE = 360;\nvar ROTATE_STEP = 1;\nvar EasyCrop = /*#__PURE__*/forwardRef(function (props, ref) {\n  var src = props.src,\n      aspect = props.aspect,\n      shape = props.shape,\n      grid = props.grid,\n      hasZoom = props.hasZoom,\n      zoomVal = props.zoomVal,\n      rotateVal = props.rotateVal,\n      setZoomVal = props.setZoomVal,\n      setRotateVal = props.setRotateVal,\n      onComplete = props.onComplete;\n\n  var _useState = useState({\n    x: 0,\n    y: 0\n  }),\n      crop = _useState[0],\n      setCrop = _useState[1];\n\n  var onCropComplete = useCallback(function (croppedArea, croppedAreaPixels) {\n    onComplete(croppedAreaPixels);\n  }, [onComplete]);\n  return /*#__PURE__*/React.createElement(Cropper, {\n    ref: ref,\n    image: src,\n    aspect: aspect,\n    cropShape: shape,\n    showGrid: grid,\n    zoomWithScroll: hasZoom,\n    crop: crop,\n    zoom: zoomVal,\n    rotation: rotateVal,\n    onCropChange: setCrop,\n    onZoomChange: setZoomVal,\n    onRotationChange: setRotateVal,\n    onCropComplete: onCropComplete,\n    classes: {\n      containerClassName: pkg + \"-container\",\n      mediaClassName: MEDIA_CLASS\n    }\n  });\n});\nEasyCrop.propTypes = {\n  src: t.string,\n  aspect: t.number,\n  shape: t.string,\n  grid: t.bool,\n  hasZoom: t.bool,\n  zoomVal: t.number,\n  rotateVal: t.number,\n  setZoomVal: t.func,\n  setRotateVal: t.func,\n  onComplete: t.func\n};\nvar ImgCrop = /*#__PURE__*/forwardRef(function (props, ref) {\n  var aspect = props.aspect,\n      shape = props.shape,\n      grid = props.grid,\n      zoom = props.zoom,\n      rotate = props.rotate,\n      beforeCrop = props.beforeCrop,\n      modalTitle = props.modalTitle,\n      modalWidth = props.modalWidth,\n      modalOk = props.modalOk,\n      modalCancel = props.modalCancel,\n      children = props.children;\n  var hasZoom = zoom === true;\n  var hasRotate = rotate === true;\n  var modalTextProps = {\n    okText: modalOk,\n    cancelText: modalCancel\n  };\n  Object.keys(modalTextProps).forEach(function (key) {\n    if (!modalTextProps[key]) delete modalTextProps[key];\n  });\n\n  var _useState2 = useState(''),\n      src = _useState2[0],\n      setSrc = _useState2[1];\n\n  var _useState3 = useState(1),\n      zoomVal = _useState3[0],\n      setZoomVal = _useState3[1];\n\n  var _useState4 = useState(0),\n      rotateVal = _useState4[0],\n      setRotateVal = _useState4[1];\n\n  var beforeUploadRef = useRef();\n  var fileRef = useRef();\n  var resolveRef = useRef(noop);\n  var rejectRef = useRef(noop);\n  var cropPixelsRef = useRef();\n  /**\n   * Upload\n   */\n\n  var renderUpload = useCallback(function () {\n    var upload = Array.isArray(children) ? children[0] : children;\n\n    var _upload$props = upload.props,\n        beforeUpload = _upload$props.beforeUpload,\n        accept = _upload$props.accept,\n        restUploadProps = _objectWithoutPropertiesLoose(_upload$props, [\"beforeUpload\", \"accept\"]);\n\n    beforeUploadRef.current = beforeUpload;\n    return _extends({}, upload, {\n      props: _extends({}, restUploadProps, {\n        accept: accept || 'image/*',\n        beforeUpload: function beforeUpload(file, fileList) {\n          return new Promise(function (resolve, reject) {\n            if (beforeCrop && !beforeCrop(file, fileList)) {\n              reject();\n              return;\n            }\n\n            fileRef.current = file;\n            resolveRef.current = resolve;\n            rejectRef.current = reject;\n            var reader = new FileReader();\n            reader.addEventListener('load', function () {\n              setSrc(reader.result);\n            });\n            reader.readAsDataURL(file);\n          });\n        }\n      })\n    });\n  }, [beforeCrop, children]);\n  /**\n   * EasyCrop\n   */\n\n  var onComplete = useCallback(function (croppedAreaPixels) {\n    cropPixelsRef.current = croppedAreaPixels;\n  }, []);\n  /**\n   * Controls\n   */\n\n  var isMinZoom = zoomVal === MIN_ZOOM;\n  var isMaxZoom = zoomVal === MAX_ZOOM;\n  var isMinRotate = rotateVal === MIN_ROTATE;\n  var isMaxRotate = rotateVal === MAX_ROTATE;\n  var subZoomVal = useCallback(function () {\n    if (!isMinZoom) setZoomVal(zoomVal - ZOOM_STEP);\n  }, [isMinZoom, zoomVal]);\n  var addZoomVal = useCallback(function () {\n    if (!isMaxZoom) setZoomVal(zoomVal + ZOOM_STEP);\n  }, [isMaxZoom, zoomVal]);\n  var subRotateVal = useCallback(function () {\n    if (!isMinRotate) setRotateVal(rotateVal - ROTATE_STEP);\n  }, [isMinRotate, rotateVal]);\n  var addRotateVal = useCallback(function () {\n    if (!isMaxRotate) setRotateVal(rotateVal + ROTATE_STEP);\n  }, [isMaxRotate, rotateVal]);\n  /**\n   * Modal\n   */\n\n  var onClose = useCallback(function () {\n    setSrc('');\n    setZoomVal(1);\n    setRotateVal(0);\n  }, []);\n  var onOk = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    var naturalImg, naturalWidth, naturalHeight, canvas, ctx, maxLen, halfMax, left, top, maxImgData, _cropPixelsRef$curren, width, height, x, y, _fileRef$current, type, name, uid;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            onClose();\n            naturalImg = document.querySelector(\".\" + MEDIA_CLASS);\n            naturalWidth = naturalImg.naturalWidth, naturalHeight = naturalImg.naturalHeight;\n            canvas = document.createElement('canvas');\n            ctx = canvas.getContext('2d'); // create a max canvas to cover the source image after rotated\n\n            maxLen = Math.sqrt(Math.pow(naturalWidth, 2) + Math.pow(naturalHeight, 2));\n            canvas.width = maxLen;\n            canvas.height = maxLen; // rotate the image\n\n            if (hasRotate && rotateVal > 0 && rotateVal < 360) {\n              halfMax = maxLen / 2;\n              ctx.translate(halfMax, halfMax);\n              ctx.rotate(rotateVal * Math.PI / 180);\n              ctx.translate(-halfMax, -halfMax);\n            } // draw the source image in the center of the max canvas\n\n\n            left = (maxLen - naturalWidth) / 2;\n            top = (maxLen - naturalHeight) / 2;\n            ctx.drawImage(naturalImg, left, top); // shrink the max canvas to the crop area size, then align two center points\n\n            maxImgData = ctx.getImageData(0, 0, maxLen, maxLen);\n            _cropPixelsRef$curren = cropPixelsRef.current, width = _cropPixelsRef$curren.width, height = _cropPixelsRef$curren.height, x = _cropPixelsRef$curren.x, y = _cropPixelsRef$curren.y;\n            canvas.width = width;\n            canvas.height = height;\n            ctx.putImageData(maxImgData, Math.round(-left - x), Math.round(-top - y)); // get the new image\n\n            _fileRef$current = fileRef.current, type = _fileRef$current.type, name = _fileRef$current.name, uid = _fileRef$current.uid;\n            canvas.toBlob( /*#__PURE__*/function () {\n              var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(blob) {\n                var newFile, res, passedFile, _type;\n\n                return _regeneratorRuntime.wrap(function _callee$(_context) {\n                  while (1) {\n                    switch (_context.prev = _context.next) {\n                      case 0:\n                        newFile = blob;\n                        newFile.lastModifiedDate = Date.now();\n                        newFile.name = name;\n                        newFile.uid = uid;\n\n                        if (!(typeof beforeUploadRef.current !== 'function')) {\n                          _context.next = 6;\n                          break;\n                        }\n\n                        return _context.abrupt(\"return\", resolveRef.current(newFile));\n\n                      case 6:\n                        res = beforeUploadRef.current(newFile, [newFile]);\n\n                        if (!(typeof res !== 'boolean' && !res)) {\n                          _context.next = 10;\n                          break;\n                        }\n\n                        console.error('beforeUpload must return a boolean or Promise');\n                        return _context.abrupt(\"return\");\n\n                      case 10:\n                        if (!(res === true)) {\n                          _context.next = 12;\n                          break;\n                        }\n\n                        return _context.abrupt(\"return\", resolveRef.current(newFile));\n\n                      case 12:\n                        if (!(res === false)) {\n                          _context.next = 14;\n                          break;\n                        }\n\n                        return _context.abrupt(\"return\", rejectRef.current('not upload'));\n\n                      case 14:\n                        if (!(res && typeof res.then === 'function')) {\n                          _context.next = 27;\n                          break;\n                        }\n\n                        _context.prev = 15;\n                        _context.next = 18;\n                        return res;\n\n                      case 18:\n                        passedFile = _context.sent;\n                        _type = Object.prototype.toString.call(passedFile);\n                        if (_type === '[object File]' || _type === '[object Blob]') newFile = passedFile;\n                        resolveRef.current(newFile);\n                        _context.next = 27;\n                        break;\n\n                      case 24:\n                        _context.prev = 24;\n                        _context.t0 = _context[\"catch\"](15);\n                        rejectRef.current(_context.t0);\n\n                      case 27:\n                      case \"end\":\n                        return _context.stop();\n                    }\n                  }\n                }, _callee, null, [[15, 24]]);\n              }));\n\n              return function (_x) {\n                return _ref2.apply(this, arguments);\n              };\n            }(), type, 0.4);\n\n          case 19:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  })), [hasRotate, onClose, rotateVal]);\n  return /*#__PURE__*/React.createElement(LocaleReceiver, null, function (locale, localeCode) {\n    return /*#__PURE__*/React.createElement(React.Fragment, null, renderUpload(), src && /*#__PURE__*/React.createElement(Modal, Object.assign({\n      visible: true,\n      wrapClassName: pkg + \"-modal\",\n      title: localeCode === 'zh-cn' && modalTitle === MODAL_TITLE ? '编辑图片' : modalTitle,\n      width: modalWidth,\n      onOk: onOk,\n      onCancel: onClose,\n      maskClosable: false,\n      destroyOnClose: true\n    }, modalTextProps), /*#__PURE__*/React.createElement(EasyCrop, {\n      ref: ref,\n      src: src,\n      aspect: aspect,\n      shape: shape,\n      grid: grid,\n      hasZoom: hasZoom,\n      zoomVal: zoomVal,\n      rotateVal: rotateVal,\n      setZoomVal: setZoomVal,\n      setRotateVal: setRotateVal,\n      onComplete: onComplete\n    }), hasZoom && /*#__PURE__*/React.createElement(\"div\", {\n      className: pkg + \"-control zoom\"\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: subZoomVal,\n      disabled: isMinZoom\n    }, \"\\uFF0D\"), /*#__PURE__*/React.createElement(Slider, {\n      min: MIN_ZOOM,\n      max: MAX_ZOOM,\n      step: ZOOM_STEP,\n      value: zoomVal,\n      onChange: setZoomVal\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: addZoomVal,\n      disabled: isMaxZoom\n    }, \"\\uFF0B\")), hasRotate && /*#__PURE__*/React.createElement(\"div\", {\n      className: pkg + \"-control rotate\"\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      onClick: subRotateVal,\n      disabled: isMinRotate\n    }, \"\\u21BA\"), /*#__PURE__*/React.createElement(Slider, {\n      min: MIN_ROTATE,\n      max: MAX_ROTATE,\n      step: ROTATE_STEP,\n      value: rotateVal,\n      onChange: setRotateVal\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: addRotateVal,\n      disabled: isMaxRotate\n    }, \"\\u21BB\"))));\n  });\n});\nImgCrop.propTypes = {\n  aspect: t.number,\n  shape: t.oneOf(['rect', 'round']),\n  zoom: t.bool,\n  grid: t.bool,\n  rotate: t.bool,\n  beforeCrop: t.func,\n  modalTitle: t.string,\n  modalWidth: t.oneOfType([t.number, t.string]),\n  modalOk: t.string,\n  modalCancel: t.string,\n  children: t.node\n};\nImgCrop.defaultProps = {\n  aspect: 1,\n  shape: 'rect',\n  grid: false,\n  zoom: true,\n  rotate: false,\n  modalTitle: MODAL_TITLE,\n  modalWidth: 520\n};\n\nexport default ImgCrop;\n"]},"metadata":{},"sourceType":"module"}